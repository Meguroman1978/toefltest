# ğŸ—ºï¸ å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

## ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³ï¼ˆ2024å¹´12æœˆ14æ—¥ï¼‰

### âœ… å®Œäº†æ¸ˆã¿æ©Ÿèƒ½

#### ã‚³ã‚¢æ©Ÿèƒ½
- [x] Reading Testï¼ˆTPOå½¢å¼ï¼‰
- [x] Listening Testï¼ˆTTSéŸ³å£°ã€è¤‡æ•°ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼å¯¾å¿œï¼‰
- [x] Speaking Testï¼ˆ5ã¤ã®å•é¡Œã‚¿ã‚¤ãƒ—ã€AIæ¡ç‚¹ï¼‰
- [x] Writing Testï¼ˆIntegrated/Academic Discussionã€AIæ¡ç‚¹ï¼‰
- [x] Vocabulary Lessonï¼ˆèªå½™ç‰¹è¨“ï¼‰

#### å­¦ç¿’æ”¯æ´æ©Ÿèƒ½
- [x] å˜èªãƒ»ç†Ÿèªå¸³ï¼ˆé–“é•ãˆãŸå˜èªã®è‡ªå‹•ä¿å­˜ï¼‰
- [x] å˜èªå¸³ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆé–“é•ã„å›æ•°Ã—æœ€è¿‘åº¦ã‚¹ã‚³ã‚¢ï¼‰
- [x] Performance Historyï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥æ­£è§£ç‡ï¼‰
- [x] AI Performance Coachï¼ˆå¼±ç‚¹åˆ†æï¼‰

#### å•é¡Œç”Ÿæˆãƒ»ç®¡ç†
- [x] YouTubeå‹•ç”»è§£æï¼ˆGemini APIï¼‰
- [x] Knowledge Baseæ§‹ç¯‰ãƒ»çµ±åˆ
- [x] å•é¡Œé‡è¤‡é˜²æ­¢ã‚·ã‚¹ãƒ†ãƒ 
- [x] ãƒˆãƒ”ãƒƒã‚¯ãƒãƒ©ã‚¨ãƒ†ã‚£ç®¡ç†
- [x] Diversity Scoreè¨ˆç®—

#### UI/UX
- [x] HomeScreenãƒ„ãƒ¼ãƒ«é †åºå¤‰æ›´
- [x] INSERT_TEXTå•é¡Œã®ãƒœã‚¿ãƒ³åŒ–ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- [x] è¤‡æ•°ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼TTSï¼ˆProfessor/Studentï¼‰
- [x] Speakingå•é¡Œã‚¿ã‚¤ãƒ—åˆ¥åˆ†æ

---

## ğŸš§ å®Ÿè£…äºˆå®šæ©Ÿèƒ½

### Phase 1: ResultScreenæ”¹å–„ï¼ˆå„ªå…ˆåº¦: ğŸ”´ é«˜ï¼‰

#### ç›®æ¨™
è§£ç­”ãƒ»è§£èª¬ç”»é¢ã‚’å¤§å¹…ã«æ”¹å–„ã—ã€å­¦ç¿’åŠ¹æœã‚’æœ€å¤§åŒ–ã™ã‚‹ã€‚

#### å®Ÿè£…å†…å®¹

##### 1. ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå¤‰æ›´
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  â”‚                  â”‚
â”‚  å·¦: å•é¡Œå†…å®¹     â”‚  å³: è§£ç­”ãƒ»è§£èª¬   â”‚
â”‚                  â”‚                  â”‚
â”‚  - ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸     â”‚  - æ­£èª¤åˆ¤å®š      â”‚
â”‚  - ã‚¹ã‚¯ãƒªãƒ—ãƒˆ     â”‚  - è§£èª¬          â”‚
â”‚  - éŸ³å£°å†ç”Ÿ       â”‚  - Tips          â”‚
â”‚                  â”‚  - å‚è€ƒæƒ…å ±      â”‚
â”‚                  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### 2. ãƒã‚¤ãƒ©ã‚¤ãƒˆæ©Ÿèƒ½
- è§£èª¬éƒ¨åˆ†ã«ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ã‚’åˆã‚ã›ã‚‹
- å¯¾å¿œã™ã‚‹å•é¡Œå†…å®¹ã®éƒ¨åˆ†ãŒè‡ªå‹•ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚‚è‡ªå‹•èª¿æ•´

##### 3. ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥å®Ÿè£…

**Reading Result Screen**:
- å·¦: ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸å…¨æ–‡ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰
- å³: å„è³ªå•ã®è§£ç­”ãƒ»è§£èª¬
- ãƒã‚¤ãƒ©ã‚¤ãƒˆ: å•é¡Œã®`relevantContext`ã‚’åŸºã«ãƒã‚¤ãƒ©ã‚¤ãƒˆ

**Listening Result Screen**:
- å·¦: ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…¨æ–‡ + éŸ³å£°å†ç”Ÿãƒœã‚¿ãƒ³
- å³: å„è³ªå•ã®è§£ç­”ãƒ»è§£èª¬
- ãƒã‚¤ãƒ©ã‚¤ãƒˆ: è§£èª¬ã«å¯¾å¿œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆéƒ¨åˆ†

**Speaking Result Screen**:
- å·¦: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ + Reading/Listeningå†…å®¹
- å³: ã‚¹ã‚³ã‚¢ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€æ”¹å–„ææ¡ˆ

**Writing Result Screen**:
- å·¦: Reading + Listeningå†…å®¹
- å³: æå‡ºã—ãŸ Essayã€ã‚¹ã‚³ã‚¢ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

#### æŠ€è¡“ä»•æ§˜
```typescript
interface EnhancedResultProps {
  passage: Passage | ListeningSet | SpeakingTask | WritingTask;
  answers: Record<string, string[]>;
  highlightedSegment?: string; // ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
  onSegmentHover?: (segment: string) => void; // ãƒ›ãƒãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ
}
```

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
- `screens/EnhancedResultScreen.tsx` - æ–°è¦ä½œæˆï¼ˆçµ±åˆç‰ˆï¼‰
- `components/ContentPanel.tsx` - å·¦å´ãƒ‘ãƒãƒ«
- `components/AnswerPanel.tsx` - å³å´ãƒ‘ãƒãƒ«
- `hooks/useHighlight.ts` - ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒ­ã‚¸ãƒƒã‚¯

---

### Phase 2: [â– ]å•é¡Œã®ç¢ºå®Ÿãªè¡¨ç¤ºï¼ˆå„ªå…ˆåº¦: ğŸ”´ é«˜ï¼‰

#### å•é¡Œ
ç¾åœ¨ã€Gemini APIãŒ[â– ]ãƒãƒ¼ã‚«ãƒ¼ã‚’ç”Ÿæˆã—ãªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã€‚

#### è§£æ±ºç­–

##### 1. ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å¼·åŒ–
```typescript
const systemInstruction = `
  **CRITICAL: INSERT TEXT MARKER REQUIREMENT**
  
  For INSERT_TEXT questions, you MUST:
  1. Select ONE paragraph (recommend paragraph 2 or 3)
  2. Insert the marker [â– ] EXACTLY 4 times within that paragraph
  3. Place markers at logical positions (after topic sentence, before conclusion, etc.)
  4. Example:
     "The ancient city was built on a hill. [â– ] The strategic location provided...
      [â– ] Archaeological evidence suggests... [â– ] Moreover, recent excavations...
      [â– ] Thus, historians now believe..."
  
  **VERIFICATION**: Ensure your generated passage contains exactly 4 occurrences of [â– ]
`;
```

##### 2. ãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ãƒƒã‚·ãƒ³ã‚°æ¤œè¨¼
```typescript
const validateInsertMarkers = (content: GeneratedContent): boolean => {
  const markerCount = content.paragraphs.join('').match(/â– /g)?.length || 0;
  if (markerCount !== 4) {
    console.error(`Invalid marker count: ${markerCount}, expected 4`);
    return false;
  }
  return true;
};
```

##### 3. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”Ÿæˆ
```typescript
if (!validateInsertMarkers(content)) {
  // è‡ªå‹•çš„ã«3æ®µè½ç›®ã«[â– ]ã‚’æŒ¿å…¥
  content.paragraphs[2] = autoInsertMarkers(content.paragraphs[2]);
}
```

---

### Phase 3: Full Testæ©Ÿèƒ½ï¼ˆå„ªå…ˆåº¦: ğŸŸ¡ ä¸­ï¼‰

#### ç›®æ¨™
4ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€£ç¶šã§å®Ÿæ–½ã—ã€ç·åˆã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚

#### å®Ÿè£…å†…å®¹

##### 1. Full Test Mode
- `mode: 'FULL_TEST'`ã‚’è¿½åŠ 
- Reading â†’ Listening â†’ Speaking â†’ Writing ã®é †ã§å®Ÿæ–½
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³é–“ã«ä¼‘æ†©æ™‚é–“ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

##### 2. ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
```typescript
interface ScoreReport {
  id: string;
  date: string;
  readingScore: number;      // 0-30
  listeningScore: number;    // 0-30
  speakingScore: number;     // 0-30
  writingScore: number;      // 0-30
  totalScore: number;        // 0-120
  
  sectionDetails: {
    reading: SectionDetail;
    listening: SectionDetail;
    speaking: SectionDetail;
    writing: SectionDetail;
  };
  
  aiAdvice: string;          // Geminiç”Ÿæˆã®ç·åˆã‚¢ãƒ‰ãƒã‚¤ã‚¹
  strengths: string[];       // å¼·ã¿
  weaknesses: string[];      // å¼±ç‚¹
  nextSteps: string[];       // æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
}

interface SectionDetail {
  score: number;
  accuracy: number;          // æ­£ç­”ç‡
  categoryBreakdown: Record<string, number>; // ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚¹ã‚³ã‚¢
  timeManagement: string;    // æ™‚é–“ç®¡ç†ã®è©•ä¾¡
}
```

##### 3. ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆUI
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         TOEFL Score Report             â”‚
â”‚                                        â”‚
â”‚  Total Score: 95 / 120                 â”‚
â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Reading    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  24/30     â”‚ â”‚
â”‚  â”‚ Listening  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  22/30     â”‚ â”‚
â”‚  â”‚ Speaking   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  27/30     â”‚ â”‚
â”‚  â”‚ Writing    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  22/30     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                        â”‚
â”‚  ğŸ“Š Strengths:                         â”‚
â”‚  â€¢ Excellent speaking fluency          â”‚
â”‚  â€¢ Strong vocabulary usage             â”‚
â”‚                                        â”‚
â”‚  âš ï¸ Areas for Improvement:             â”‚
â”‚  â€¢ Listening: Note-taking skills       â”‚
â”‚  â€¢ Writing: Essay organization         â”‚
â”‚                                        â”‚
â”‚  ğŸ’¡ Next Steps:                        â”‚
â”‚  â€¢ Practice Listening signal words     â”‚
â”‚  â€¢ Study essay templates               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Phase 4: éå»ã®ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆç®¡ç†ï¼ˆå„ªå…ˆåº¦: ğŸŸ¡ ä¸­ï¼‰

#### å®Ÿè£…å†…å®¹

##### 1. ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆå±¥æ­´ä¿å­˜
```typescript
// localStorage: 'toefl_score_reports'
interface ScoreReportHistory {
  reports: ScoreReport[];
  lastUpdated: string;
}
```

##### 2. æ¨ç§»ã‚°ãƒ©ãƒ•
```typescript
// Chart.js ã¾ãŸã¯ Recharts ã‚’ä½¿ç”¨
<LineChart data={reports}>
  <Line dataKey="readingScore" stroke="#4F46E5" />
  <Line dataKey="listeningScore" stroke="#06B6D4" />
  <Line dataKey="speakingScore" stroke="#F97316" />
  <Line dataKey="writingScore" stroke="#A855F7" />
</LineChart>
```

##### 3. AIæ¨ç§»åˆ†æ
```typescript
const analyzeTrend = async (reports: ScoreReport[]): Promise<string> => {
  const prompt = `
    Analyze the following score progression and provide insights:
    ${JSON.stringify(reports, null, 2)}
    
    Identify:
    1. Which sections are improving/declining
    2. Possible reasons for changes
    3. Specific recommendations for continued improvement
  `;
  
  return await geminiAnalyze(prompt);
};
```

---

### Phase 5: Knowledge Baseãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¿å­˜ï¼ˆå„ªå…ˆåº¦: ğŸŸ¢ ä½ï¼‰

#### ç¾çŠ¶ã®èª²é¡Œ
- localStorageã®ã¿ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ä¾å­˜ï¼‰
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°æ™‚ã«ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã‚‹å¯èƒ½æ€§

#### è§£æ±ºç­–

##### Option 1: Cloudflare KVï¼ˆæ¨å¥¨ï¼‰
```typescript
// Cloudflare Workers KVã‚’ä½¿ç”¨
const KV_NAMESPACE = 'TOEFL_KB';

export const saveKnowledgeBase = async (kb: KnowledgeBase): Promise<void> => {
  await fetch('/api/kb', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(kb)
  });
};

export const loadKnowledgeBase = async (): Promise<KnowledgeBase | null> => {
  const response = await fetch('/api/kb');
  if (!response.ok) return null;
  return await response.json();
};
```

##### Option 2: Firebase/Supabase
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- èªè¨¼æ©Ÿèƒ½ï¼ˆå°†æ¥çš„ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå¯¾å¿œï¼‰

---

## ğŸ¯ æ¬¡å›ä½œæ¥­ã®å„ªå…ˆé †ä½

### ä»Šã™ãå®Ÿè£…ã™ã¹ãï¼ˆæœ¬æ—¥ä¸­ï¼‰
1. âœ… HomeScreen ãƒ„ãƒ¼ãƒ«é †åºå¤‰æ›´ï¼ˆå®Œäº†ï¼‰
2. â³ [â– ]å•é¡Œã®ç¢ºå®Ÿãªç”Ÿæˆï¼ˆã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå¼·åŒ–ï¼‰
3. â³ ResultScreenæ”¹å–„ï¼ˆReadingç”¨ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ï¼‰

### ä»Šé€±ä¸­ã«å®Ÿè£…
4. Enhanced ResultScreen for Listening
5. Enhanced ResultScreen for Speaking/Writing
6. Full Test Modeï¼ˆåŸºæœ¬å®Ÿè£…ï¼‰

### ä»Šæœˆä¸­ã«å®Ÿè£…
7. ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
8. ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆå±¥æ­´ç®¡ç†
9. 2026å¹´æ–°å½¢å¼ã®å•é¡Œã‚¿ã‚¤ãƒ—è¿½åŠ 

---

## ğŸ“Š å·¥æ•°è¦‹ç©ã‚‚ã‚Š

| ã‚¿ã‚¹ã‚¯ | è¦‹ç©ã‚‚ã‚Šæ™‚é–“ | å„ªå…ˆåº¦ |
|-------|-------------|--------|
| [â– ]å•é¡Œä¿®æ­£ | 30åˆ† | ğŸ”´ é«˜ |
| ResultScreenæ”¹å–„ï¼ˆReadingï¼‰ | 2æ™‚é–“ | ğŸ”´ é«˜ |
| ResultScreenæ”¹å–„ï¼ˆListeningï¼‰ | 1.5æ™‚é–“ | ğŸ”´ é«˜ |
| ResultScreenæ”¹å–„ï¼ˆSpeaking/Writingï¼‰ | 2æ™‚é–“ | ğŸ”´ é«˜ |
| Full Test Mode | 3æ™‚é–“ | ğŸŸ¡ ä¸­ |
| ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ | 2æ™‚é–“ | ğŸŸ¡ ä¸­ |
| ã‚¹ã‚³ã‚¢ãƒ¬ãƒãƒ¼ãƒˆå±¥æ­´ | 2æ™‚é–“ | ğŸŸ¡ ä¸­ |
| KBãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¿å­˜ | 4æ™‚é–“ | ğŸŸ¢ ä½ |

**åˆè¨ˆ**: ç´„17æ™‚é–“

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [TOEFL_2026_NEW_FORMAT.md](./TOEFL_2026_NEW_FORMAT.md) - 2026å¹´æ–°å½¢å¼ä»•æ§˜
- [YOUTUBE_ANALYSIS_IMPLEMENTATION.md](./YOUTUBE_ANALYSIS_IMPLEMENTATION.md) - YouTubeè§£ææ©Ÿèƒ½
- [DEPLOY_DECEMBER_2024.md](./DEPLOY_DECEMBER_2024.md) - ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰

---

**ã“ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¯ç¶™ç¶šçš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚**
